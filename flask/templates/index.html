<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>HackTownUSA</title>

    <!-- Bootstrap -->
    <link href="static/css/bootstrap.min.css" rel="stylesheet">
    <link href="static/css/styles.css" rel="stylesheet">
<script type="text/javascript" src="static/js/app.js"></script>
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      {% with messages = get_flashed_messages() %} {% if messages %}
      <ul class=flashes>
          {% for message in messages %}
          <li>{{ message }}</li>
          {% endfor %}
      </ul>
      {% endif %} {% endwith %}

<!----- NAVIGATION ------------->
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
      </button>
      <a class="navbar-brand" href="#">Lane8</a>
    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
   <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
     <ul class="nav navbar-nav">
       <li class="active"><a href="#">Home<span class="sr-only">(current)</span></a></li>
         </ul>
       </li>
     </ul>
       </li>
     </ul>
   </div><!-- /.navbar-collapse -->
 </div><!-- /.container-fluid -->
</nav>

    {% with messages = get_flashed_messages() %} {% if messages %}
    <ul class=flashes>
        {% for message in messages %}
        <li>{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %} {% endwith %}

        <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
            <div class="row">
                <div class="12-md-col">
                    <h1>Title of Page</h1>
                    <h4>Lane8</h4>
                    <p>APIs, APIs, and more APIs</p>
                </div>
            </div>

                <div class="container">
                    <div class="row">
                        <input type="text" name="query" placeholder="Type in what you want to search!">
                        <select id = 'ideas'>
                            <option>Basketball</option>
                            <option>Oregon</option>
                            <option>Kim Kardashian</option>
                            <option>Adele</option>
                        </select>
                        <button id="submit" type="button" class="btn btn-default" onclick="getPoints()">Submit</button>
                        </div>
                    </div>
    
        <div id='map'></div>
    



    <div id="tweeter">
    <a class="twitter-timeline" href="https://twitter.com/search?q=corgi" data-widget-id="658116944541843456"></a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>

    <script type="text/javascript">
        /*global google*/
        var map, heatmap;
        $SCRIPT_ROOT = {{request.script_root | tojson | safe}};

        function initMap() {
            "use strict";
            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 5,
                center: {lat: 38.8833, lng: -102.9833},
                mapTypeId: google.maps.MapTypeId.ROADMAP,
                disableDefaultUI: true,
                scrollwheel: false,
                zoomControl: false,
                navigationControl: false,
                mapTypeControl: false,
                scaleControl: false,
                draggable: false,
                disableDoubleClickZoom: false
            });
            var happy_gradient = [
                'rgba(255, 255, 255, 0)', //Transparent
                'rgba(255, 255, 180, 0.5)',
                'rgba(255, 255, 100, 0.8)',
                'rgba(255, 255, 40, 1)',
                'rgba(255, 255, 20, 1)',
                'rgba(255, 255, 10, 1)',
                'rgba(255, 255, 0, 1)'
                
            ]

            var sad_gradient = [
                'rgba(255, 255, 255, 0)',
                'rgba(255, 200, 200, 0.5)',
                'rgba(255, 160, 100, 0.8)',
                'rgba(255, 120, 60, 1)',
                'rgba(255, 80, 40, 1)',
                'rgba(255, 40, 20, 1)',
                'rgba(255, 0, 0, 1)'
            ]

            $("button#submit").click(function() {

                var $value = $('#ideas option:selected').text();
                $("#tweeter a").attr("href", "https://twitter.com/search?q=" + $value);
                twttr.widgets.load();
                $.ajax({
                    url: $SCRIPT_ROOT + '/_tweet_calcs', //TO DO
                    type: 'GET',
                    dataType: 'json',
                    data: {
                        'query' : $value
                    },
                    success: function(json) {
                        console.log(json);
                        var happy_array = [];
                        var sad_array = [];
                        $.each(json.result, function (i, item) {
                            var coordinates = new google.maps.LatLng(parseInt(item.lat), parseInt(item.lng));
                            if (item.wgt < 0){
                                var weightedLoc = {location: coordinates, weight: item.wgt*-1};
                                sad_array.push(weightedLoc);
                            }else if(item.wgt>0){
                                var weightedLoc = {location: coordinates, weight: item.wgt};
                                happy_array.push(weightedLoc);
                            }
                        }); 
                        var sad_heatmap = new google.maps.visualization.HeatmapLayer({
                            data: sad_array,
                            map: map,
                            radius: 90,
                            gradient: sad_gradient,
                          //opacity: 1
                        });                      


                        var happy_heatmap = new google.maps.visualization.HeatmapLayer({
                            data: happy_array,
                            map: map,
                            radius: 90,
                            gradient: happy_gradient,
                            //opacity: .6
                        });
                        
                    },
                    error: function (xhr, desc, err) {
                        console.log(xhr);
                        console.log("Details: " + desc + "\nError: " + err);
                    }
                })
            });

    /*
    happy_heatmap = new google.maps.visualization.HeatmapLayer({
    data: getPoints2(),
    map: map
    });

    heatmap3 = new google.maps.visualization.HeatmapLayer({
        data: test(),
        map: map,
        radius: 100
    }); */
        }


    function toggleHeatmap() {
    "use strict";
    heatmap.setMap(heatmap.getMap() ? null : map);
    }

    /*function changeGradient() {
    var gradient = [
    'rgba(0, 255, 255, 0)',
    'rgba(0, 0, 223, 1)',
    'rgba(0, 0, 255, 1)',
    'rgba(0, 63, 255, 1)',
    'rgba(0, 127, 255, 1)',
    'rgba(0, 191, 255, 1)',
    'rgba(0, 255, 255, 1)',
    'rgba(0, 255, 255, 0)', //Transparent
    'rgba(0, 0, 191, 1)',
    'rgba(0, 0, 159, 1)',
    'rgba(0, 0, 127, 1)',
    'rgba(63, 0, 91, 1)',
    'rgba(127, 0, 63, 1)',
    'rgba(191, 0, 31, 1)',
    'rgba(0, 0, 191, 1)',
    ]
    heatmap.set('gradient', heatmap.get('gradient') ? null : gradient);
    }

    function changeRadius() {
    heatmap.set('radius', heatmap.get('radius') ? null : 20);
    }

    function changeOpacity() {
    heatmap.set('opacity', heatmap.get('opacity') ? null : 0.2);
    }*/

    // Heatmap data: 500 Points

    </script>

    <script async defer src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=visualization&callback=initMap"></script>




  </body>
</html>
